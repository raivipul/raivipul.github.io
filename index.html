<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Vipul Rai — Portfolio</title>
  <meta name="description" content="Personal portfolio / projects site" />
  <link rel="icon" href="data:;base64,iVBORw0KGgo=" />
  <!-- Optional: include Inter font -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0a0e1a; --card:#0f1724; --muted:#8b95a5; --accent:#7c5cff; --secondary:#4ae8c6;
      --glass: rgba(255,255,255,0.06); --border: rgba(255,255,255,0.08);
      --radius:16px; --container:1100px; --shadow: 0 8px 32px rgba(0,0,0,0.4);
      color-scheme: dark;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:'Inter',ui-sans-serif,system-ui,-apple-system,'Segoe UI',Roboto;
      background:radial-gradient(circle at 20% 80%, rgba(124,92,255,0.15) 0%, transparent 50%),
                 radial-gradient(circle at 80% 20%, rgba(74,232,198,0.15) 0%, transparent 50%),
                 linear-gradient(135deg, var(--bg) 0%, #051018 100%);
      color:#e8f0ff; overflow-x:hidden}
    a{color:inherit;text-decoration:none;transition:all 0.3s ease}

    /* Page System */
    .page{display:none;min-height:100vh;opacity:0;transform:translateY(20px);transition:all 0.5s ease}
    .page.active{display:block;opacity:1;transform:translateY(0)}
    .container{max-width:var(--container);margin:0 auto;padding:20px}

    /* Enhanced Header */
    header{position:fixed;top:0;left:0;right:0;background:rgba(10,14,26,0.85);backdrop-filter:blur(20px);
           border-bottom:1px solid var(--border);padding:16px 0;z-index:100;transition:all 0.3s ease}
    nav{display:flex;gap:20px;align-items:center;justify-content:space-between;max-width:var(--container);margin:0 auto;padding:0 20px}
    .brand{display:flex;gap:12px;align-items:center;cursor:pointer}
    .logo{width:48px;height:48px;border-radius:12px;background:linear-gradient(135deg,var(--accent),var(--secondary));
          display:flex;align-items:center;justify-content:center;font-weight:800;font-size:18px;
          box-shadow:0 4px 20px rgba(124,92,255,0.3)}
    .navlinks{display:flex;gap:8px;align-items:center}
    .nav-item{padding:10px 16px;border-radius:12px;font-size:14px;color:var(--muted);cursor:pointer;
              transition:all 0.3s ease;position:relative}
    .nav-item:hover,.nav-item.active{color:#fff;background:var(--glass)}
    .cta{padding:12px 20px;background:linear-gradient(135deg,var(--accent),var(--secondary));
         border-radius:12px;color:#0a0e1a;font-weight:600;cursor:pointer;
         box-shadow:0 4px 16px rgba(124,92,255,0.3);transition:all 0.3s ease}
    .cta:hover{transform:translateY(-2px);box-shadow:0 6px 24px rgba(124,92,255,0.4)}

    /* Floating Particles */
    .particles{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:1}
    .particle{position:absolute;width:4px;height:4px;background:rgba(124,92,255,0.3);border-radius:50%;
              animation:float 20s infinite linear}
    @keyframes float{0%{transform:translateY(100vh) rotate(0deg)} 100%{transform:translateY(-100px) rotate(360deg)}}

    /* Enhanced Hero */
    .hero{display:grid;grid-template-columns:1fr 400px;gap:40px;align-items:center;padding:120px 0 80px;min-height:100vh}
    .intro h1{font-size:clamp(32px, 5vw, 48px);margin:0 0 16px;background:linear-gradient(135deg,#fff,var(--secondary));
              -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
    .intro .subtitle{font-size:18px;color:var(--secondary);font-weight:500;margin:0 0 16px}
    .intro p{color:var(--muted);line-height:1.7;margin:0 0 24px;font-size:16px}
    .hero-actions{display:flex;gap:16px;margin:24px 0;flex-wrap:wrap}
    .btn-primary{padding:14px 28px;background:linear-gradient(135deg,var(--accent),var(--secondary));
                 border-radius:12px;color:#0a0e1a;font-weight:600;cursor:pointer;transition:all 0.3s ease;
                 box-shadow:0 4px 20px rgba(124,92,255,0.3)}
    .btn-primary:hover{transform:translateY(-2px);box-shadow:0 6px 28px rgba(124,92,255,0.4)}
    .btn-secondary{padding:14px 28px;border:1px solid var(--border);border-radius:12px;color:var(--muted);
                   cursor:pointer;transition:all 0.3s ease;backdrop-filter:blur(10px)}
    .btn-secondary:hover{border-color:var(--accent);color:#fff;background:var(--glass)}

    .skills-grid{display:flex;gap:12px;flex-wrap:wrap;margin:24px 0}
    .skill-tag{padding:8px 16px;background:var(--glass);border:1px solid var(--border);border-radius:20px;
               font-size:13px;color:var(--muted);transition:all 0.3s ease}
    .skill-tag:hover{border-color:var(--accent);color:var(--secondary);transform:translateY(-2px)}

    /* Enhanced Profile Card */
    .profile-card{background:linear-gradient(135deg,var(--glass),rgba(255,255,255,0.02));
                  padding:24px;border-radius:20px;backdrop-filter:blur(20px);
                  border:1px solid var(--border);box-shadow:var(--shadow);position:relative;overflow:hidden}
    .profile-card::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;
                         background:linear-gradient(90deg,var(--accent),var(--secondary))}
    .profile-photo{width:100%;height:320px;border-radius:16px;background:linear-gradient(135deg,var(--accent),var(--secondary));
                   background-size:cover;background-position:center;margin-bottom:16px}
    .profile-info h3{margin:0 0 8px;font-size:20px}
    .profile-info .role{color:var(--secondary);font-size:14px;font-weight:500}
    .profile-actions{display:flex;gap:8px;margin:16px 0 0}
    .profile-btn{padding:8px 16px;background:var(--glass);border:1px solid var(--border);border-radius:8px;
                 font-size:12px;color:var(--muted);transition:all 0.3s ease;cursor:pointer}
    .profile-btn:hover{border-color:var(--accent);color:#fff}

    /* Projects Grid */
    .projects-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(320px,1fr));gap:24px;margin:32px 0}
    .project-card{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:24px;
                  transition:all 0.3s ease;cursor:pointer;position:relative;overflow:hidden}
    .project-card::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;
                         background:linear-gradient(90deg,var(--accent),var(--secondary));transform:scaleX(0);
                         transition:transform 0.3s ease;transform-origin:left}
    .project-card:hover::before{transform:scaleX(1)}
    .project-card:hover{transform:translateY(-4px);border-color:rgba(124,92,255,0.3);
                       box-shadow:0 12px 40px rgba(124,92,255,0.2)}
    .project-card h3{margin:0 0 12px;color:#fff;font-size:18px}
    .project-card p{color:var(--muted);margin:0 0 16px;line-height:1.6}
    .project-tags{display:flex;gap:8px;flex-wrap:wrap;margin:16px 0}
    .project-tag{padding:4px 12px;background:rgba(124,92,255,0.15);color:var(--accent);border-radius:16px;font-size:11px;
                 border:1px solid rgba(124,92,255,0.3)}

    /* Education & Experience */
    .timeline{position:relative;padding-left:32px}
    .timeline::before{content:'';position:absolute;left:16px;top:0;bottom:0;width:2px;
                     background:linear-gradient(180deg,var(--accent),var(--secondary))}
    .timeline-item{position:relative;margin-bottom:32px;background:var(--card);border:1px solid var(--border);
                   border-radius:16px;padding:24px;transition:all 0.3s ease}
    .timeline-item::before{content:'';position:absolute;left:-40px;top:24px;width:12px;height:12px;
                          background:var(--accent);border-radius:50%;border:3px solid var(--bg)}
    .timeline-item:hover{border-color:rgba(124,92,255,0.3);transform:translateX(4px)}
    .timeline-title{color:var(--accent);font-weight:600;font-size:16px;margin:0 0 4px}
    .timeline-subtitle{color:#fff;font-weight:500;margin:0 0 4px}
    .timeline-meta{color:var(--muted);font-size:13px;font-style:italic;margin:0 0 12px}
    .timeline-content ul{margin:8px 0;padding-left:16px;color:var(--muted)}
    .timeline-content li{margin:4px 0;line-height:1.6}

    /* Quote Box */
    .quote-box{background:linear-gradient(135deg,rgba(124,92,255,0.15),rgba(74,232,198,0.1));
               padding:32px;border-radius:20px;margin:32px 0;border:1px solid rgba(124,92,255,0.3);
               position:relative;text-align:center}
    .quote-box::before{content:'"';position:absolute;top:16px;left:24px;font-size:48px;
                      color:var(--accent);opacity:0.3;font-family:serif}
    .quote-text{font-style:italic;margin:0;color:#fff;font-size:18px;line-height:1.6}
    .quote-attribution{margin:16px 0 0;font-size:14px;color:var(--muted)}

    /* Contact Section */
    .contact-grid{display:grid;grid-template-columns:1fr 1fr;gap:32px;margin:32px 0}
    .contact-info{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:24px}
    .contact-links{display:flex;flex-direction:column;gap:12px}
    .contact-link{padding:12px 16px;background:var(--glass);border:1px solid var(--border);
                  border-radius:12px;color:var(--muted);transition:all 0.3s ease;cursor:pointer}
    .contact-link:hover{border-color:var(--accent);color:#fff;transform:translateX(4px)}

    /* Footer */
    footer{margin-top:80px;padding:32px 0;border-top:1px solid var(--border);text-align:center;color:var(--muted)}

    /* Mobile Responsive */
    @media (max-width:880px){
      .hero{grid-template-columns:1fr;text-align:center}
      .profile-card{order:-1;max-width:300px;margin:0 auto}
      .navlinks{display:none}
      .contact-grid{grid-template-columns:1fr}
      .timeline{padding-left:16px}
      .timeline::before{left:8px}
      .timeline-item::before{left:-20px}
    }

    /* Loading Animation */
    .loading{position:fixed;top:0;left:0;width:100%;height:100%;background:var(--bg);
             display:flex;align-items:center;justify-content:center;z-index:1000}
    .loading-spinner{width:50px;height:50px;border:3px solid rgba(124,92,255,0.3);
                     border-top:3px solid var(--accent);border-radius:50%;animation:spin 1s linear infinite}
    @keyframes spin{0%{transform:rotate(0deg)} 100%{transform:rotate(360deg)}}
  </style>
</head>
<body>
  <!-- Loading Screen -->
  <div class="loading" id="loading" role="status" aria-live="polite">
    <div class="loading-spinner" aria-hidden="true"></div>
  </div>

  <!-- Floating Particles -->
  <div class="particles" id="particles" aria-hidden="true"></div>

  <!-- Header -->
  <header>
    <nav>
      <div class="brand" onclick="showPage('home', this)">
        <div class="logo">VR</div>
        <div>
          <div style="font-weight:700">Vipul Rai</div>
          <div style="font-size:12px;color:var(--muted)">Physicist</div>
        </div>
      </div>
      <div class="navlinks">
        <!-- pass `this` to showPage so script doesn't rely on global event -->
        <div class="nav-item active" onclick="showPage('home', this)">Home</div>
        <div class="nav-item" onclick="showPage('projects', this)">Projects</div>
        <div class="nav-item" onclick="showPage('about', this)">About</div>
        <div class="nav-item" onclick="showPage('experience', this)">Experience</div>
        <div class="nav-item" onclick="showPage('contact', this)">Contact</div>
        <div class="cta" onclick="showPage('contact', this)">Hire me</div>
      </div>
    </nav>
  </header>

  <!-- Page: Home -->
  <div class="page active" id="home">
    <div class="container">
      <section class="hero">
        <div class="intro">
          <div class="subtitle">Physicist & Researcher</div>
          <h1>Hi — I'm Vipul Rai</h1>
          <p>I'm a PhD student at IIT Mandi, working on non-equilibrium statistical mechanics and stochastic thermodynamics. My research explores how information processing, especially in the context of Landauer erasure, links to heat dissipation. I also develop theoretical and computational models for animal homing behavior.</p>

          <div class="hero-actions">
            <div class="btn-primary" onclick="showPage('projects', this)">View Projects</div>
            <div class="btn-secondary" onclick="showPage('about', this)">My Story</div>
          </div>

          <div class="skills-grid">
            <div class="skill-tag">Statistical Mechanics</div>
            <div class="skill-tag">Quantum Mechanics</div>
            <div class="skill-tag">Langevin Dynamics</div>
            <div class="skill-tag">Information Theory</div>
            <div class="skill-tag">Active Matter</div>
          </div>
        </div>

        <aside class="profile-card">
          <div class="profile-photo" aria-hidden="true"></div>
          <div class="profile-info">
            <h3>Vipul Rai</h3>
            <div class="role">Senior Research Fellow</div>
          </div>
          <div class="profile-actions">
            <div class="profile-btn" onclick="showPage('contact', this)">Email</div>
            <div class="profile-btn" onclick="showPage('projects', this)">Projects</div>
          </div>
        </aside>
      </section>
    </div>
  </div>

  <!-- Page: Projects -->
  <div class="page" id="projects">
    <div class="container" style="padding-top:100px">
      <h1 style="text-align:center;margin:40px 0;background:linear-gradient(135deg,#fff,var(--secondary));-webkit-background-clip:text;-webkit-text-fill-color:transparent">Selected Projects</h1>

      <div class="projects-grid">
        <!-- project cards... (kept same as provided) -->
        <div class="project-card">
          <h3>Information Erasure Optimization</h3>
          <p>Optimizing Finite-Time Memory Erasure by Potential Shaping using stochastic thermodynamics principles.</p>
          <div class="project-tags">
            <span class="project-tag">Landauer Erasure</span>
            <span class="project-tag">Maxwell Demon</span>
            <span class="project-tag">Thermodynamics</span>
          </div>
          <div style="margin-top:16px;color:var(--accent);cursor:pointer">View Project →</div>
        </div>

        <div class="project-card">
          <h3>Active Brownian Robots</h3>
          <p>Theoretical frameworks using active Brownian robots to model animal homing behavior and navigation strategies.</p>
          <div class="project-tags">
            <span class="project-tag">ABP</span>
            <span class="project-tag">Run & Tumble</span>
            <span class="project-tag">Navigation</span>
          </div>
          <div style="margin-top:16px;color:var(--accent);cursor:pointer">View Project →</div>
        </div>

        <div class="project-card">
          <h3>Stochastic Dynamics</h3>
          <p>Transport phenomena in mesoscopic systems using advanced stochastic differential equations.</p>
          <div class="project-tags">
            <span class="project-tag">Fokker-Planck</span>
            <span class="project-tag">SDE</span>
            <span class="project-tag">Transport</span>
          </div>
          <div style="margin-top:16px;color:var(--accent);cursor:pointer">View Project →</div>
        </div>

        <div class="project-card">
          <h3>Quantum Heat Engines</h3>
          <p>Modeling quantum amplifiers as heat engines and refrigerators with efficiency analysis.</p>
          <div class="project-tags">
            <span class="project-tag">Quantum Thermo</span>
            <span class="project-tag">Heat Engines</span>
            <span class="project-tag">Efficiency</span>
          </div>
          <div style="margin-top:16px;color:var(--accent);cursor:pointer">View Project →</div>
        </div>

        <div class="project-card">
          <h3>NV Centers in Diamond</h3>
          <p>Synthesis and characterization of nanodiamonds for next-generation quantum technologies.</p>
          <div class="project-tags">
            <span class="project-tag">NV Centers</span>
            <span class="project-tag">MPCVD</span>
            <span class="project-tag">Quantum Tech</span>
          </div>
          <div style="margin-top:16px;color:var(--accent);cursor:pointer">View Project →</div>
        </div>

        <div class="project-card">
          <h3>Quantum Entanglement</h3>
          <p>Quantifying entanglement between quantum systems and path detectors in quantum mechanics.</p>
          <div class="project-tags">
            <span class="project-tag">Entanglement</span>
            <span class="project-tag">Quantum Info</span>
            <span class="project-tag">Path Detection</span>
          </div>
          <div style="margin-top:16px;color:var(--accent);cursor:pointer">View Project →</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Page: About -->
  <div class="page" id="about">
    <div class="container" style="padding-top:100px">
      <h1 style="text-align:center;margin:40px 0;background:linear-gradient(135deg,#fff,var(--secondary));-webkit-background-clip:text;-webkit-text-fill-color:transparent">About Me</h1>

      <div style="max-width:800px;margin:0 auto">
        <p style="font-size:18px;line-height:1.7;color:var(--muted);text-align:center;margin:0 0 40px">
          Passionate physicist exploring stochastic dynamics and computational physics. Currently pursuing Ph.D. research at IIT Mandi with focus on theoretical physics and complex systems.
        </p>

        <div class="quote-box">
          <div class="quote-text">"Luck is superposition of all possible states."</div>
          <div class="quote-attribution">— Personal philosophy in this probabilistic world</div>
        </div>

        <h2 style="color:var(--accent);margin:48px 0 24px">Education</h2>
        <div class="timeline">
          <div class="timeline-item">
            <div class="timeline-title">Ph.D. in Physics</div>
            <div class="timeline-subtitle">IIT Mandi</div>
            <div class="timeline-meta">2023 – Present</div>
            <div class="timeline-content">
              <p style="color:var(--muted);margin:0">Research focus on non-equilibrium statistical mechanics, stochastic thermodynamics, and information theory applications in biological systems.</p>
            </div>
          </div>

          <div class="timeline-item">
            <div class="timeline-title">M.Sc. in Physics</div>
            <div class="timeline-subtitle">NIT Karnataka</div>
            <div class="timeline-meta">2020 – 2022</div>
            <div class="timeline-content">
              <p style="color:var(--muted);margin:0">Specialized in quantum mechanics, statistical physics, and solid state physics with excellent academic performance.</p>
            </div>
          </div>

          <div class="timeline-item">
            <div class="timeline-title">B.Sc. Physics Honours</div>
            <div class="timeline-subtitle">Central University of Himachal Pradesh</div>
            <div class="timeline-meta">2015 – 2018</div>
            <div class="timeline-content">
              <p style="color:var(--muted);margin:0">Foundation in classical physics, quantum mechanics, and mathematical methods with honors degree.</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Page: Experience -->
  <div class="page" id="experience">
    <div class="container" style="padding-top:100px">
      <h1 style="text-align:center;margin:40px 0;background:linear-gradient(135deg,#fff,var(--secondary));-webkit-background-clip:text;-webkit-text-fill-color:transparent">Experience</h1>

      <div style="max-width:900px;margin:0 auto">
        <div class="timeline">
          <div class="timeline-item">
            <div class="timeline-title">Senior Research Fellow</div>
            <div class="timeline-subtitle">IIT Mandi</div>
            <div class="timeline-meta">2023 – Present</div>
            <div class="timeline-content">
              <ul>
                <li>Working in area of non-equilibrium statistical mechanics and stochastic thermodynamics</li>
                <li>Developing theoretical models for information processing and heat dissipation in Landauer erasure</li>
                <li>Creating computational models for animal homing behavior using active Brownian robots</li>
              </ul>
            </div>
          </div>

          <div class="timeline-item">
            <div class="timeline-title">Junior Research Fellow</div>
            <div class="timeline-subtitle">UM DAE Centre for Excellence in Basic Sciences (CEBS)</div>
            <div class="timeline-meta">July 2023 – September 2023</div>
            <div class="timeline-content">
              <ul>
                <li>NV Center Based Single Crystal Diamond for Next Generation Quantum Technologies</li>
                <li>Synthesized nanodiamonds using the pulsed laser ablation method</li>
                <li>Operated Microwave Plasma Chemical Vapor Deposition (MPCVD) and Electron Beam Evaporation systems</li>
              </ul>
            </div>
          </div>

          <div class="timeline-item">
            <div class="timeline-title">Visiting Student</div>
            <div class="timeline-subtitle">Harish-Chandra Research Institute</div>
            <div class="timeline-meta">2022 – 2023</div>
            <div class="timeline-content">
              <ul>
                <li>Studies open quantum system and dissipation in Quantum Mechanics</li>
                <li>Modelled Quantum Amplifier as Heat Engine & Refrigerator</li>
                <li>Investigated the Efficiency of Heat Engine following Curzon & Ahlborn Efficiency</li>
              </ul>
            </div>
          </div>

          <div class="timeline-item">
            <div class="timeline-title">Research Internship</div>
            <div class="timeline-subtitle">Indian Institute of Science Education and Research - Kolkata</div>
            <div class="timeline-meta">June 2021 – September 2021</div>
            <div class="timeline-content">
              <ul>
                <li>Quantified the Entanglement between the Quantum system and the Path Detector</li>
                <li>Applied Quantum Information Theory principles to analyze quantum measurement</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Page: Contact -->
  <div class="page" id="contact">
    <div class="container" style="padding-top:100px">
      <h1 style="text-align:center;margin:40px 0;background:linear-gradient(135deg,#fff,var(--secondary));-webkit-background-clip:text;-webkit-text-fill-color:transparent">Get In Touch</h1>

      <div style="max-width:600px;margin:0 auto;text-align:center">
        <p style="font-size:18px;color:var(--muted);margin:0 0 40px">
          Want to collaborate on research or discuss physics? I'm always open to interesting conversations and opportunities.
        </p>

        <div class="contact-grid">
          <div class="contact-info">
            <h3 style="margin:0 0 20px;color:var(--accent)">Contact Information</h3>
            <div class="contact-links">
              <a class="contact-link" href="mailto:vipulrai457@gmail.com">
                📧 vipulrai457@gmail.com
              </a>
              <a class="contact-link" href="https://github.com/raivipul" target="_blank" rel="noopener">
                🐱 GitHub Profile
              </a>
              <a class="contact-link" href="https://www.linkedin.com/in/vipul-rai-98b696109" target="_blank" rel="noopener">
                💼 LinkedIn Profile
              </a>
            </div>
          </div>

          <div class="contact-info">
            <h3 style="margin:0 0 20px;color:var(--accent)">Research Interests</h3>
            <div style="color:var(--muted);line-height:1.6">
              <p>• Statistical Mechanics</p>
              <p>• Stochastic Thermodynamics</p>
              <p>• Information Theory</p>
              <p>• Active Matter Systems</p>
              <p>• Quantum Technologies</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <footer>
    <div class="container">
      <p>© <span id="year"></span> Vipul Rai. Built with passion for physics and code.</p>
    </div>
  </footer>

  <script>
    // Page Management
    let currentPage = 'home';

    // showPage accepts optional element (el) to mark active nav item
    function showPage(pageId, el) {
      try {
        // hide current page
        const prev = document.getElementById(currentPage);
        if (prev) prev.classList.remove('active');

        // update nav items
        document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));

        // prefer explicit element if passed, otherwise try to find a matching nav-item
        if (el instanceof Element) {
          el.classList.add('active');
        } else {
          const candidate = Array.from(document.querySelectorAll('.nav-item'))
            .find(i => {
              const onclick = i.getAttribute('onclick') || '';
              return onclick.includes(`'${pageId}'`) || onclick.includes(`"${pageId}"`);
            });
          if (candidate) candidate.classList.add('active');
        }

        // show new page with animation
        setTimeout(() => {
          const next = document.getElementById(pageId);
          if (next) next.classList.add('active');
          currentPage = pageId;
          window.scrollTo({ top: 0, behavior: 'smooth' });
        }, 200);
      } catch (err) {
        console.error('showPage error:', err);
      }
    }

    // Particle System: create single particle
    function createParticle() {
      const container = document.getElementById('particles');
      if (!container) return;
      const particle = document.createElement('div');
      particle.className = 'particle';
      particle.style.left = Math.random() * 100 + '%';
      particle.style.animationDelay = Math.random() * 20 + 's';
      particle.style.animationDuration = (Math.random() * 10 + 10) + 's';
      container.appendChild(particle);
      // remove after animation ends (safe cleanup)
      setTimeout(() => particle.remove(), 30000);
    }

    // Limit number of particles and spawn at intervals
    let particleInterval;
    function startParticles() {
      const maxParticles = 40;      // safety cap
      particleInterval = setInterval(() => {
        const container = document.getElementById('particles');
        if (!container) return;
        if (container.children.length < maxParticles) createParticle();
      }, 600); // spawn every 600ms
    }
    function stopParticles() {
      clearInterval(particleInterval);
    }

    // Global error handler: log and hide loader so page doesn't stay blank forever
    window.addEventListener('error', (e) => {
      console.error('Global error caught:', e.error || e.message || e);
      const loader = document.getElementById('loading');
      if (loader) loader.style.display = 'none';
      // stop particles if running
      stopParticles();
    });

    // Initialize once DOM is ready
    document.addEventListener('DOMContentLoaded', () => {
      // set dynamic year
      const yearEl = document.getElementById('year');
      if (yearEl) yearEl.textContent = new Date().getFullYear();

      // hide loader
      const loader = document.getElementById('loading');
      if (loader) loader.style.display = 'none';

      // start particles (limited)
      startParticles();

      // ensure the initial page is shown and correct nav item highlighted
      showPage(currentPage);
    });

    // Fallback: if something blocks JS, ensure loader is hidden after 8s (graceful degrade)
    setTimeout(() => {
      const loader = document.getElementById('loading');
      if (loader && loader.style.display !== 'none') loader.style.display = 'none';
    }, 8000);
  </script>
</body>
</html>
